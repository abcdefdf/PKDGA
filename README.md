# PKDGA
PKDGA is an adversarial domain generation algorithm that uses a small amount of detector information for reinforcement learning training.

# Installation and Usage Hints
PKDGA is created, trained and evaluated on Ubuntu 16.04 or Win10 using Python.

# reproducibility
## PKDGA
1.Create a anaconda environment:

conda create -n <environment_name> pytohn==3.6 // environment_name is the name of the created environment

2.Install the required packages:

pip -r install requirement.txt

3.Pre-train the target domain detector

command???

The screenshots of pre-training process is

![image](https://github.com/abcdefdf/PKDGA/assets/98793069/6c389df8-cc9c-4b81-b755-4f007cd2863b)

(4) Training PKDGA to compromise the target detector
command??

The screenshots of pre-training process is

![image](https://github.com/abcdefdf/PKDGA/assets/98793069/f00f3f3f-f3ed-4314-a7bd-72969678a1ba)

Then users can use the following command to produce domains

command??

Some samples are shown as follows.

The usages of files in PKDGA/ are introduced as follows. 

rollout.py: policy gradient, to make the token sequence Y resisting against target detector D, we maximize its expected reward.  

gen_model.py: train the model.  exp1.py: the first experimental code in the paper.  

gen_sample.py: generate domain names by loading the trained model.  

exp1.py: the first experimental code in the paper.  

exp2.py: the second experimental code in the paper.  

file_check.py: other functions that need to be called.


Then we present the brief introduction and usage of the evaluated domain detectors.
## RF
Introduction: DGA detector, it extracts 21 lightweight DGA features, including structural, linguistic and statistical features, and employs a supervised model (Random Forest) for classification.
Usage: Python ./adverse/rf.py

## bilstm,lstm,textcnn
Introduction: DGA detector, directly leverage neural networks to distinguish AGDs from benign ones without extracting features manually.
Usage: Python ./adverse/lstm_class.py -layer -emb -hid -use_cuda
Python ./adverse/lstm_class.py -layer -emb -hid -use_cuda
Python ./adverse/cnn.py  -use_cuda
Python ./adverse/lstmmi.py  -use_cuda
Python ./adverse/cnn-lstm.py  -use_cuda
Python ./adverse/bilstm.py -max_features - maxlen -use_cuda
## graph
DGA detector, graph is able to detect dictionary-based AGDs that are generated by concatenating words from a predefined dictionary. It constructs a graph describing the relationships between the largest common substrings in a domain and the graph with average degrees larger than a threshold is considered as malicious. In our implementation, the substrings that repeat more than three times are considered as basic words, and the degree threshold is set to 3.
## statics
DGA detector, argues that AGDs follow different distributions from the legitimate domain names. A domain is identified as benign if it has a negligible distance from the legitimate domains. In particular, it measures the distance using Kullback-Leibler divergence, Jaccard index and Edit distance.
## khaos
DGA, builds a dictionary containing n-grams of legitimate domain names and trains a wasserstein generative adversarial network (WGAN) to synthesize domain names by merging the sampled n-grams. In our implementation, we set the embedding size of n-grams to 5,000. The domain synthesizer and the discriminator are implemented using the residual convolutional network.
Usage:

# Disclaimer
This project is still under development and may be missing at the moment. In addition, some paths may require you to modify.
